import ScrollableAnchor from 'react-scrollable-anchor'
import { Link } from 'react-router-dom'

import streamListing from './images/streams/stream-listing.png'
import streamSettings from './images/streams/setup-your-stream.png'

import docsStyles from '$newdocs/components/DocsLayout/docsLayout.pcss'
import links from '$shared/../links'
import CodeSnippet from '$shared/components/CodeSnippet'

import {
    CreateJavascriptClient,
    CreateJavaClient,
    AuthJavascriptClient,
    AuthJavaClient,
    SubscribeJavascriptClient,
    SubscribeJavaClient,
    PublishJavascriptClient,
    PublishJavaClient,
} from './code/streams.js'

<ScrollableAnchor id="intro-to-streams"><div>

## Intro to streams
--content--

</div></ScrollableAnchor>

<ScrollableAnchor id="work-with-streams-in-core"><div>

## Work with streams in Core
Streamr Core provides you with the tools to create, edit, share and delete your streams as well as view and inspect the streams you have purchased on the Marketplace.

### Overview of your streams
Head over to the <Link to={links.userpages.streams}>Streams page</Link> to see an overview of your subscribed streams. The list includes streams you have created and streams that you have purchased on the Marketplace.

<img src={streamListing} />

This stream listing page gives an indication for when data was last pushed to each stream and uses traffic light indicators show the health of each stream, at a glance.

| Color        | Status                           |
| ------------ | -------------------------------- |
| Green        | Stream is receiving data         |
| Red          | Stream is not receiving data     |

Clicking on a stream will open the stream editor. You may only edit streams that you have created or have explicit permission to edit.

By clicking on the more options icon you may access advanced features for each stream, such as stream sharing and code snippets.
A new stream can be created by the clicking the "Create Stream" button on the <Link to={links.userpages.streams}>Streams page</Link>.

### Editing a stream
Stream editor provides basic tools for setting up, inspecting and editing your stream.

<img src={streamSettings} />

#### Details section
The details section provides basic information about your stream. The stream name is used to identify your stream in the Core app. 

The stream description can be used to offer more information about your stream and the kind of data it contains. 

The stream ID is the unique identifier for your stream
and is needed when interacting with the <Link to={links.newdocs.SDKs}>Streamr SDKs</Link>.

#### Configure section
In this section you can configure stream fields and their data types. All fields have a name and a data type.
The Autodetect feature can be used to automatically deduce fields from the stream's last received message. It is possible to manually correct the data types if automatic detection is not suitable for your stream.
It is possible to manually correct the data types if automatic detection is not perfect.

| Setting                                             | Explanation                                                                                                  |
| ----------------------------------------------------| ------------------------------------------------------------------------------------------------------------ |
| Always try to autoconfigure field names and types   | Streamr will try to automatically configure field names and types on the very first message the stream receives         |
| Require all messages in this stream to be signed    | Streamr will not accept messages that are not signed                                                         |

#### Preview section
This section is used to preview data flowing into the stream. Use the live inspector to make sure your stream is receiving data and it is correctly formatted.

#### API Access section
Here you can manage API keys for your stream. Keys generated here grant access to only this stream and can have either read or write access. These keys can also be removed if for example, the key has been compromised.
Keys can also be deleted which is useful in cases where your key has e.g. leaked.

#### Historical Data section
This section contains the stream's historical data storage settings and includes tools to add or remove historical data from the stream. 

You can add new data to the stream by uploading a CSV file and you can delete existing historical data from the stream by choosing an inclusive date range. 

The historical data storage period determines how many days your data is retained before it will be removed automatically from the Streamr network. The default period is 365 days.
by date. Also historical data storage period can be controlled here. It determines how many days your data is retained before it will be removed
automatically from the system.

</div></ScrollableAnchor>

<ScrollableAnchor id="work-with-streams-via-sdks"><div>

## Work with streams via SDKs

The easiest way to work with streams is to use the JavaScript client, which works in `node.js` as well as the browser. See the <Link to={links.newdocs.SDKs}>SDKs section</Link> for the official and community-maintained client libraries available for various languages:

- **JavaScript** client works in the browser as well as node.js.
- **Java** client is work-in-progress but already implements the most important set of functionality.

Client libraries for other languages are on the <a href={links.community.trello} target="_blank" rel="nofollow noopener noreferrer">roadmap</a>. If a client library isn't available for your language, you can dive into the details of the [websocket protocol](https://github.com/streamr-dev/streamr-client-protocol-js/blob/bb2f0168bcff454b5c458e275e9c2de0dee342f9/PROTOCOL.md).

If you'd like to contribute a client library and get it listed here, please get in touch on <a href={links.community.telegram} target="_blank" rel="nofollow noopener noreferrer">Telegram</a>, <a href={links.community.reddit} target="_blank" rel="nofollow noopener noreferrer">Reddit</a> or <a href={links.contact.general} rel="nofollow noopener noreferrer">email</a>!

### Authentication

When reading from or writing to Streams, you need to provide a session token or an API key, or login with an Ethereum account. To read more about API keys or obtaining a session token, refer to the <Link to={links.newdocs.api}>Authentication section of the API documentation</Link>.

### Creating a client instance with API key

**Javascript**

<CodeSnippet language='javascript'>{CreateJavascriptClient}</CodeSnippet>

**Java**

<CodeSnippet language='java'>{CreateJavaClient}</CodeSnippet>

### Subscribing to real-time events in a stream

By subscribing to Streams, your application gets immediately notified about new events in the Stream. 

**JavaScript**

<CodeSnippet language='javascript'>{SubscribeJavascriptClient}</CodeSnippet>

**Java**

<CodeSnippet language='java'>{SubscribeJavaClient}</CodeSnippet>

### Publishing events to Streams

JavaScript:

<CodeSnippet language='javascript'>{PublishJavascriptClient}</CodeSnippet>

Java:

Events in Streams are key-value pairs, represented in Java as Map objects. Below is an example of creating an event payload and publishing it into a Stream:

<CodeSnippet language='java'>{PublishJavaClient}</CodeSnippet>

</div></ScrollableAnchor>

<ScrollableAnchor id="work-with-streams-via-api"><div>

## Work with streams via API
--content--

</div></ScrollableAnchor>

<ScrollableAnchor id="data-signing-and-verification"><div>

## Data signing and verification
--content--

</div></ScrollableAnchor>

<ScrollableAnchor id="end-to-end-encryption"><div>

## End-to-end encryption
--content--

</div></ScrollableAnchor>

<ScrollableAnchor id="partitioning"><div>

## Partitioning
--content--

</div></ScrollableAnchor>
